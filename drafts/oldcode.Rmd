---
title: "Old Code"
author: "David John Baker"
date: "27/10/2020"
output: html_document
---



```{r}
df %>%
  group_by(participant, chord, experimental_group) %>%
  mutate(avg_rating = mean(rating)) %>%
  select(avg_rating) %>%
  distinct() -> avg_chord_ratings

# model_data %>%
#   left_join(avg_chord_ratings) %>%
#   select(avg_rating, lerdhal_tension, parncut_roughness, rootmotion, number_tendency_tones4_6,semitone_voice_move, chord_family, experimental_group) %>% 
#   distinct() %>%
#   ggpairs(mapping = aes(color = experimental_group))

```




* Need to change rating scale underneath
* No approaching statistical significance 

To do this, we created a regression model which incorporated the five features from table TABLE.

* Important to include group and training as random slope to know if groups differ.

Before fitting this model, EDA (not for pubication?) highlights some of the difficulty in fitting features to our atrraction variable. 

```{r}
model_data %>%
  ggplot(aes(y = rating, x = lerdhal_tension, color = experimental_group)) +
  geom_jitter(alpha = .2) +
  geom_smooth(method = "lm") +
  labs(title = "Lerdhal Tension vs Rating") -> eda_3_lerdhal

ggsave(filename = "img/analysis_eda_lerdhal.png",plot = eda_3_lerdhal)

model_data %>%
  ggplot(aes(y = rating, x = parncut_roughness, color = chord_family)) +
  geom_point() +
  facet_wrap(~experimental_group) +
  geom_smooth(method = "lm") +
  labs(title = "Parncutt Roughness vs Rating", subtitle = "") -> eda_3_parncutt
  
ggsave(filename = "img/analysis_eda_parcutt.png",plot = eda_3_parcutt)

model_data %>%
  ggplot(aes(y = rating, x = parncut_roughness, color = experimental_group)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(title = "Parncutt Roughness vs Rating", subtitle = "")
  
model_data %>%
  ggplot(aes(y = rating, x = semitone_voice_move, color = chord_family)) +
  geom_point() +
  geom_smooth(method = "lm") +
  facet_wrap(~experimental_group) +
  labs(title = "Semitone Voice Move vs Rating") -> eda_3_semitone

ggsave(filename = "img/analysis_eda_semitone.png",plot = eda_3_semitone)

model_data %>%
  ggplot(aes(y = rating, x = semitone_voice_move, color = experimental_group)) +
  geom_jitter(alpha = .2) +
  geom_smooth(method = "lm") +
  labs(title = "Semitone Voice Move vs Rating")

# Large class imbalance 
model_data %>%
  group_by(rootmotion) %>%
  tally()

model_data %>%
  filter(!is.na(rootmotion)) %>%
  mutate(rootmotion = as.factor(rootmotion)) %>%
  ggplot(aes(y = rating, x = rootmotion, color = chord_family)) +
  geom_boxplot() +
  geom_smooth(method = "lm") +
  facet_wrap(~experimental_group) +
  labs(title = "Root Motion vs Rating", subtitle = "Circularity Problem: Not Overlapping Categories") -> feature_space_problem 


ggsave(filename = "img/analysis_feature_space_problem.png",plot = feature_space_problem)

model_data %>%
  ggplot(aes(y = rating, x = number_tendency_tones4_6, color = chord_family)) +
  geom_jitter(alpha = .2) +
  geom_smooth(method = "lm") +
  labs(title = "Tendency Tones vs Rating", subtitle = "Unequal Categories") -> ten_tones

ggsave(filename = "img/analysis_tendency_tones.png",plot = ten_tones)
```


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
